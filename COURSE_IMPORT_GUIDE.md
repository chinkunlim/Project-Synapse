# 課程導入和自動生成會話指南

## 概述

當你導入課程 CSV 文件時，系統現在會：
1. ✅ 在 **Course Hub** 數據庫中創建課程記錄
2. ✅ 自動在 **Course Sessions** 數據庫中為每門課程生成 **18 堂課程會話**
3. ✅ 根據學期的開始和結束日期自動計算每堂課的日期

## 使用步驟

### 1️⃣ 進入 Notion 管理面板
前往 `http://localhost:5001/notion`

### 2️⃣ 定位到 CSV 數據導入卡片
找到「CSV 數據導入」區域

### 3️⃣ 選擇課程數據庫
```
選擇目標數據庫 → 課程
```

### 4️⃣ 設置學期日期 ⭐
當你選擇「課程」時，會自動出現兩個日期字段：

```
【學期開始日期】 選擇學期的第一天
【學期結束日期】 選擇學期的最後一天
```

**例子：**
- 學期開始日期：`2025-09-01`
- 學期結束日期：`2025-12-31`

### 5️⃣ 上傳課程 CSV 文件
點擊「下載樣本」了解 CSV 格式，然後上傳你的課程 CSV 文件

### 6️⃣ 點擊「上傳並導入」
系統會：
- 導入課程到 Course Hub
- 自動計算課程間隔（總週數 ÷ 18）
- 為每門課程生成 18 堂課程會話
- 自動關聯課程和會話

## 課程 CSV 格式

### 必填欄位
```csv
Name,Code,Instructor,Schedule,Credits
資料結構,CS101,王教授,週一 09:00-12:00,3
演算法,CS201,李教授,週三 13:00-16:00,3
機器學習,CS301,陳教授,週五 09:00-12:00,3
```

| 欄位 | 說明 | 例子 |
|------|------|------|
| **Name** | 課程名稱 | 資料結構 |
| **Code** | 課程代碼 | CS101 |
| **Instructor** | 教師名稱 | 王教授 |
| **Schedule** | 上課時間 | 週一 09:00-12:00 |
| **Credits** | 學分 | 3 |

## 自動生成的課程會話

### 會話命名規則
每堂課程會話會自動命名為：
```
[課程名稱] - 第 N 週
```

**例子：**
- 資料結構 - 第 1 週
- 資料結構 - 第 2 週
- ...
- 資料結構 - 第 18 週

### 日期計算邏輯

系統會根據以下公式計算每堂課的日期：

```
每堂課的週數間隔 = (學期結束日期 - 學期開始日期) / 18 週

第 N 堂課的日期 = 學期開始日期 + (N - 1) × 週數間隔
```

**具體例子：**

假設：
- 學期開始：2025-09-01（星期一）
- 學期結束：2025-12-31（星期三）
- 總天數：122 天 ≈ 17.4 週
- 週數間隔：17.4 ÷ 18 ≈ 0.97 週 ≈ 1 週

那麼課程會話的日期將是：
```
第 1 週：2025-09-01
第 2 週：2025-09-08
第 3 週：2025-09-15
第 4 週：2025-09-22
...
第 18 週：2025-12-22
```

## 課程和會話的關聯

每個自動生成的課程會話都會：
1. 在課程會話數據庫中創建一個新頁面
2. 自動關聯到對應的課程（通過「Course」關聯字段）
3. 設置正確的會話日期

這樣，你就可以：
- 📌 在課程頁面查看所有相關的會話
- 📝 在每個會話中添加筆記、作業等內容
- 📊 根據日期篩選和排序課程會話

## 導入結果

導入完成後，你會看到日誌消息：

```
✅ 導入完成：成功 3 筆，失敗 0 筆；已生成 54 堂課程會話
```

這表示：
- ✅ 成功導入了 3 門課程
- ✅ 自動生成了 54 堂課程會話（3 門課 × 18 堂 = 54 堂）

## 常見問題

### Q: 如果我修改課程信息，會話會自動更新嗎？
A: 不會。會話是在導入時生成的獨立記錄。如果需要更新會話，請手動修改或重新導入課程。

### Q: 我可以生成不同數量的會話嗎？
A: 目前系統固定生成 18 堂課程會話。如果需要自定義，請修改 `processor.py` 中的 `_generate_course_sessions` 方法。

### Q: 什麼如果學期日期設置錯誤？
A: 導入時會驗證日期格式。如果格式不正確，系統會在操作日誌中顯示錯誤信息。

### Q: 課程會話會自動創建筆記數據庫嗎？
A: 不會。課程會話是獨立的數據庫記錄。你可以在課程會話中手動添加關聯的筆記，或在筆記中關聯課程會話。

## 配置變數

系統使用以下環境變數：

| 環境變數 | 說明 |
|---------|------|
| `COURSE_HUB_ID` | Course Hub 數據庫 ID（必須設置） |
| `CLASS_SESSION_ID` | Course Sessions 數據庫 ID（導入課程時需要） |

請確保在 `.env` 文件中設置了這些變數。

## 示例流程

```
1. 準備課程 CSV 文件
   ↓
2. 訪問 http://localhost:5001/notion
   ↓
3. 選擇「課程」數據庫
   ↓
4. 設置學期日期（例：2025-09-01 到 2025-12-31）
   ↓
5. 上傳 CSV 文件
   ↓
6. 點擊「上傳並導入」
   ↓
7. 等待導入完成
   ↓
8. 查看日誌中的成功消息
   ↓
9. ✅ 在 Notion 中查看新創建的課程和會話
```

## 下一步

導入課程後，你可以：
1. 📚 在每個課程會話中添加筆記
2. 📝 創建課程作業和考試
3. 🔗 建立課程會話和資源之間的關聯
4. 📊 跟踪課程進度

祝你使用愉快！🎓
